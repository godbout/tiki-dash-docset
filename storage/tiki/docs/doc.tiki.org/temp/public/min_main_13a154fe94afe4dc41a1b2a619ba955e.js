/**** start overview of included js files *****/

/* list of files for rank:60late */
/* Array
(
    [0] => lang/en/language.js
    [1] => lib/captcha/captchalib.js
    [2] => lib/jquery_tiki/autoToc.js
    [3] => lib/jquery_tiki/pluginedit_list.js
    [4] => vendor_bundled/vendor/jquery-plugins/nestedsortable/jquery.ui.nestedSortable.js
    [5] => vendor/npm-asset/lozad/dist/lozad.js
)
 */

/* rank:60late - minify:ok. lang/en/language.js */

/* rank:60late - minify:ok. lib/captcha/captchalib.js */

/* rank:60late - minify:ok. lib/jquery_tiki/autoToc.js */

/* rank:60late - minify:ok. lib/jquery_tiki/pluginedit_list.js */

/* rank:60late - minify:ok. vendor_bundled/vendor/jquery-plugins/nestedsortable/jquery.ui.nestedSortable.js */

/* rank:60late - minify:ok. vendor/npm-asset/lozad/dist/lozad.js */

/**** end overview of included js files *****/
;
/* rank:60late - minify:ok. lang/en/language.js */
lang={};
/* rank:60late - minify:ok. lib/captcha/captchalib.js */
function generateCaptcha(){jQuery('#captchaImg').attr('src','img/spinner.gif').show();jQuery('body').css('cursor','progress');jQuery.ajax({url:'antibot.php',dataType:'json',success:function(data){jQuery('#captchaImg').attr('src',data.captchaImgPath);jQuery('#captchaId').attr('value',data.captchaId);jQuery('body').css('cursor','auto')}});$("#antibotcode").focus();return!1};
/* rank:60late - minify:ok. lib/jquery_tiki/autoToc.js */
$.genAutoToc=function(){var $page=$("body"),$top=$("#top"),$row;var $output=$output||"#autotoc";var toc="";var start=0;var toc_offset=parseInt(jqueryTiki.autoToc_offset);var toc_pos=jqueryTiki.autoToc_pos;var toc_mode=jqueryTiki.autoToc_inline;var toc_title="";var toc_levels=!1;if(typeof jqueryAutoToc!=="undefined"){toc_offset=parseInt(jqueryAutoToc.plugin_autoToc_offset);toc_pos=jqueryAutoToc.plugin_autoToc_pos;toc_mode=jqueryAutoToc.plugin_autoToc_mode;toc_title=jqueryAutoToc.plugin_autoToc_title!=='undefined'?"<h3>"+jqueryAutoToc.plugin_autoToc_title+"</h3>":"";if(jqueryAutoToc.plugin_autoToc_levels!=null&&jqueryAutoToc.plugin_autoToc_levels!=='undefined'){toc_levels=!0}}else{$('<style type="text/css">body{position:relative}#autotoc .nav>li>a{display:block;padding:4px 20px;font-size:13px;font-weight:500}#autotoc .nav>li>a:hover,#autotoc .nav>li>a:focus{padding-left:19px;text-decoration:none;background-color:transparent;border-left:1px solid #0075ff}#autotoc .nav-link.active,#autotoc .nav-link.active:hover,#autotoc .nav-link.active:focus{padding-left:30px;font-weight:700;background-color:transparent;border-left:2px solid #0075ff}#autotoc .nav-link+ul{display:none;padding-bottom:10px}#autotoc .nav .nav>li>a{padding-top:1px;padding-bottom:1px;padding-left:30px;font-size:12px;font-weight:400}#autotoc .nav .nav>li>a:hover,#autotoc .nav .nav>li>a:focus{padding-left:29px}#autotoc .nav .nav>li>.active,#autotoc .nav .nav>li>.active:hover,#autotoc .nav .nav>li>.active:focus{padding-left:28px;font-weight:500}#autotoc .nav-link.active+ul{display:block}@media screen and (max-width:991px){.hidden{display:none!important}}</style>').appendTo('head')}
if($top.length&&location.href.indexOf("tiki-print.php")==-1){var container=document.querySelector(container)||document.querySelector('#page-data');var children=container.children;if(countHeadings(children)>0){$row=$("<div class='row'/>");$container=$("<div class='container'/>");if(toc_pos==="left"||toc_pos==="top"){var $tocNav=$("<div id='all-toc' class='col-md-5 hidden'/>");var $page_data=$("#page-data").addClass("col-md-7 clearfix");$('<style type="text/css">#autotoc .nav > li{max-width: 350px;}</style>').appendTo('head')}else if(toc_pos==="right"){var $tocNav=$("<div id='all-toc' class='col-md-4 hidden'/>");var $page_data=$("#page-data").addClass("col-md-8 clearfix")}
var $nav=$("<nav id='autotoc'>");var processedId={};function processId(id){if(id in processedId){processedId[id]+=1;var newId=id+"_"+processedId[id]}else{processedId[id]=0;newId=id}
return newId}
if(toc_pos=='page'){toc=toc_title!=''?"<h3>"+toc_title+"</h3>":""}
for(var i=0;i<children.length;i++){var isHeading=children[i].nodeName.match(/^H\d+$/);if(isHeading){var level=children[i].nodeName.substr(1);var headerText=(children[i].textContent);var id=children[i].getAttribute("id");if(!id){id=processId(aText.replace(/\W/g,"_"))}else{id=id.replace(":","\\:").replace(".","\\.").replace("#","\\#")}
children[i].setAttribute("id",id);var url="#"+id;if(headerText){if(toc_levels){if(jqueryAutoToc.plugin_autoToc_levels.includes(level.toString())){if(level>start){if(toc_pos=='page'){toc+=(new Array(level-start+1)).join("<ul>")}else{toc+=(new Array(level-start+1)).join("<ul class='nav navbar-nav'>")}}else if(level<start){toc+=(new Array(start-level+1)).join('</li></ul>')}else{toc+=(new Array(start+1)).join('</li>')}
start=parseInt(level);if(toc_pos=='page'){toc+="<li><a href='"+url+"'>"+headerText+"</a>"}else{toc+="<li class><a class='nav-link' href='"+url+"'>"+headerText+"</a>"}}}else{if(level>start){if(toc_pos=='page'){toc+=(new Array(level-start+1)).join("<ul>")}else{toc+=(new Array(level-start+1)).join("<ul class='nav navbar-nav'>")}}else if(level<start){toc+=(new Array(start-level+1)).join('</li></ul>')}else{toc+=(new Array(start+1)).join('</li>')}
start=parseInt(level);if(toc_pos=='page'){toc+="<li><a href='"+url+"'>"+headerText+"</a>"}else{toc+="<li class><a class='nav-link' href='"+url+"'>"+headerText+"</a>"}}}}}
if(start){toc+=(new Array(start+1)).join('</ul>')}
if(toc_pos=='page'){$("#page-data").removeClass("col-md-8").addClass("col-md-12");document.querySelector($output).innerHTML+=toc}else{var fixed_height=0;if(!toc_mode){buildContent();$('<style type="text/css">.affix{top:'+toc_offset+'px;}</style>').appendTo('head');$(window).resize(function(){var page=document.getElementById("page-data");if(window.innerWidth<=991){if(page.hasAttribute('class')){page.setAttribute("class","col-md-12")}}else{if(toc_pos==="left"||toc_pos==="top"){page.setAttribute("class","col-md-7")}else{page.setAttribute("class","col-md-8")}}
affix()}).resize();controllSpy(toc_offset);function affix(){$(window).on('scroll',function(e){var scrollpos=$(window).scrollTop();var offsetpos=$('#page-data').height()-$('#autotoc > .nav').height();var top=$('#page-data').offset().top-(toc_offset+fixed_height);var bottom=$('#page-data').offset().top+$('#page-data').height()-$('#autotoc > .nav').height()-(toc_offset+fixed_height);if(scrollpos>top){if(scrollpos>bottom){$('#autotoc > .nav').removeClass('affix').addClass('affix-bottom').css('top',offsetpos+'px')}else{$('#autotoc > .nav').addClass('affix').removeClass('affix-bottom').css('top','')}}else{$('#autotoc > .nav').removeClass('affix')}
$('#autotoc .nav li a').each(function(){if($(this).hasClass('active')){$(this).parents('li').addClass('open')}else{$(this).parentsUntil('.navbar-nav .nav').removeClass('open')}})})}}else{buildContent();$('<style type="text/css">#all-toc{top:'+toc_offset+'px;}</style>').appendTo('head');$('#all-toc').height($('#page-data').height()-2000);controllSpy(toc_offset)}
function controllSpy(toc_offset){var fixed_height=0;$page.scrollspy({target:"#autotoc",offset:(toc_offset+fixed_height)})}
function buildContent(){$nav.prepend(toc);if(toc_pos==="left"||toc_pos==="top"){$("#page-data").removeClass("col-md-8").addClass("col-md-7");$("#all-toc").removeClass("col-md-4").addClass("col-md-5");$tocNav.prepend($nav);$page_data.prependTo($row);$tocNav.prependTo($row)}else{$tocNav.prepend($nav);$tocNav.prependTo($row);$page_data.prependTo($row)}
$row.prependTo($top)}}}}};function countHeadings(children){var count=0;for(var i=0;i<children.length;i++){var isHeading=children[i].nodeName.match(/^H\d+$/);if(isHeading){count++}}
return count}
$(document).ready(function(){$.genAutoToc();$('#autotoc a[href^="#"]').on('click',function(e){e.preventDefault();var target=this.hash;var $target=$(target);$('html, body').stop().animate({'scrollTop':$target.offset().top},900,'swing',function(){})})});
/* rank:60late - minify:ok. lib/jquery_tiki/pluginedit_list.js */
$(document).off('plugin_list_ready').on('plugin_list_ready',function(params){var $textarea=params.modal.find("textarea[name=content]");jqueryTiki.plugins.list.setup($textarea)});$(document).ready(function(){jqueryTiki.plugins=jqueryTiki.plugins||{};jqueryTiki.plugins.list={current:{},fields:{},plugins:{},objectType:null,$editor:null,setup:function($textarea){var gui=this;gui.current={};gui.fields={};gui.plugins={};gui.trackers={};gui.objectType=null;gui.sortableOptions={listType:"ul",maxLevels:2,handle:"div:first",items:"li",disableNesting:"no-nesting"};gui.$editor=$("<div>").addClass('plugin-list-editor clearfix');var buildMainToolbar=function(){var $tb=$("<div>").addClass("btn-toolbar").append(gui.buildToolBar(gui.plugins,"","",function(){if($(this).data("plugin")){var params=[];if($(this).data("value")){params[$(this).data("value")]=""}
$ul.append(gui.addPlugin({name:$(this).data("plugin"),params:params,plugins:[]})).nestedSortable(gui.sortableOptions);return!1}
$(".dropdown-menu",$tb).hide()}));$(".dropdown-toggle",$tb).removeClass("btn-link btn-sm").addClass("btn-primary btn-sm");return $tb};var $toolbar=buildMainToolbar();gui.$editor.append($toolbar);var $ul=$("<ul>").addClass('plugin-list-gui clearfix').appendTo(gui.$editor);var toggleGui=function(){if($textarea.is(":visible")){showGui()}else{gui.saveToTextarea();$("#source-tab").tab("show")}};var showGui=function(){let $form=$textarea.parents("form");$form.tikiModal(tr("Loading..."));$textarea.parents(".row").find("> label").hide().parent().find("> .col-sm-9").removeClass("col-sm-9").addClass("col-sm-12").find(".description").hide();$.getJSON($.service("plugin","list_edit"),{body:$textarea.val()},function(data){try{if(data){$ul.empty().show();$(".gui-only",$toolbar).prop("disabled",!1).css("opacity",1);gui.current=data.current;gui.plugins=data.plugins;gui.fields=data.fields;gui.fields.formatted=[];gui.trackers=data.trackers;for(var p=0;p<gui.current.length;p++){if(gui.current[p].name==="format"&&typeof gui.current[p].params.name!=="undefined"){gui.fields.formatted.push(gui.current[p].params.name)}}
for(p=0;p<gui.current.length;p++){$ul.append(gui.addPlugin(gui.current[p]))}
if(jqueryTiki.select2){gui.$editor.find("select").trigger("change.select2")}
$toolbar.replaceWith(buildMainToolbar()).applySelect2();$form.find(".nav-tabs li:first-child a").tab("show");$form.tikiModal()}}catch(e){console.error(e);$ul.empty().hide();$toolbar.hide();$form.tikiModal()
$("#source-tab").tabs("show").find($textarea).showError(tr("List plugin syntax is currently not compatible with the GUI, so source editing only is available."))}})};$ul.nestedSortable(gui.sortableOptions);let $tabs=$("<ul>").addClass("nav nav-tabs").append($("<li>").addClass("nav-item").append($("<a>").addClass("nav-link").attr("id","editor-tab").attr("href","#editor").text(tr("Editor")).on("click",function(e){e.preventDefault();showGui()})),$("<li>").addClass("nav-item").append($("<a>").addClass("nav-link").attr("id","source-tab").attr("href","#source").text(tr("Source")).on("click",function(e){e.preventDefault();gui.saveToTextarea();$(this).tab('show')})),$("<li>").addClass("nav-item").append($("<a>").addClass("nav-link").attr("id","params-tab").attr("href","#params").text(tr("Parameters")).on("click",function(e){e.preventDefault();$("#editor").find(".done").removeClass("done");$(this).tab('show')})));let $form=$textarea.parents("form");let $params=$(".form-group:not(:last)",$form).detach();let $tabContent=$("<div>").addClass("tab-content").append($("<div>").attr("id","editor").addClass("tab-pane mt-2").append(gui.$editor),$("<div>").attr("id","source").addClass("tab-pane mt-2").append($textarea.detach()),$("<div>").attr("id","params").addClass("tab-pane mt-2").append($params.detach()));$form.append($tabs,$tabContent).submit(function(){return $textarea.is(":visible")||gui.saveToTextarea()});showGui()},saveToTextarea:function(){var $ul=this.$editor.find(".plugin-list-gui"),currentPlugins,markup="";var findPlugins=function($element,parentPluginName){parentPluginName=parentPluginName||"";var plugins=[];$element.find(".plugin").each(function(){var body,$plugin=$(this),pluginName=$plugin.data("name"),params={};$plugin.find("> .params .input-group").each(function(){var $param=$(this),paramName=$param.find(".param-name > span").text();params[paramName]=$param.find("> select, > input").val()});if($plugin.is(".done")){return plugins}
if(parentPluginName){$plugin.addClass("done")}
if(pluginName==="wiki text"){body=$plugin.find("textarea").val()}else{body=""}
plugins.push({name:pluginName,params:params,body:body,plugins:findPlugins($plugin,pluginName),parent:parentPluginName})});return plugins},getSyntax=function(plugin,indent,noLineFeeds){indent=indent&&!noLineFeeds?indent:"  ";noLineFeeds=noLineFeeds||!1;var name=plugin.plugins.length?plugin.name.toUpperCase():plugin.name;var output="\n\n";if(name==="wiki text"){output=plugin.body}else{output=indent+"{"+name+(plugin.plugins.length?"(":"");for(var param in plugin.params){if(plugin.params.hasOwnProperty(param)){output+=" "+param+"=\""+plugin.params[param]+"\""}}
output+=(plugin.plugins.length?")":"")+"}";if(!noLineFeeds){output+="\n"}
for(var i=0;i<plugin.plugins.length;i++){output+=getSyntax(plugin.plugins[i],indent+"  ",name==="OUTPUT"&&!plugin.params.template)}
if(plugin.plugins.length){output+="{"+name+"}\n"}}
return output};currentPlugins=findPlugins($ul);for(var i=0;i<currentPlugins.length;i++){markup+=getSyntax(currentPlugins[i])}
this.$editor.parents("form").find("textarea[name=content]").val(markup);return!0},addPlugin:function(plugin,parentPath){var gui=this,pluginName=plugin.name,paramsDef=gui.plugins[pluginName]?gui.plugins[pluginName].params:null,parentPlugin;parentPath=parentPath||"";parentPlugin=gui.getPlugin(parentPath);if(typeof plugin==='string'){pluginName=tr("wiki text");plugin=plugin.replace(/^\s*[\r\n]/,"");if(!$.trim(plugin)){return null}}else if(pluginName==="wiki text"){plugin=""}else if(!paramsDef&&parentPlugin.params){paramsDef=parentPlugin.params}
if(!paramsDef&&typeof plugin!=='string'){console.log("addPlugin error: "+pluginName+"->"+parentPlugin.name+" not found");return null}
var $li=$("<li>").addClass("plugin inline-form card mb-3").data("name",pluginName).append($("<div>").addClass("card-header d-flex justify-content-between").append($("<div>").addClass("d-flex").append($("<div>").addClass("name").text(pluginName)),$("<a>").addClass("close small text-danger").html("&times;").click(function(){$(this).parents("li:first").remove()})));if(pluginName!=="output"&&pluginName!=="format"){$li.addClass("no-nesting")}else{$li.find(".card-header > div:first").append($("<div>").addClass("btn-toolbar ml-5").append(gui.buildToolBar(gui.plugins,pluginName,"",function(){if($(this).data("plugin")){var params=[];if($(this).data("value")){params[$(this).data("value")]=""}
$ul.append(gui.addPlugin({name:$(this).data("plugin"),params:params,plugins:[]})).nestedSortable(gui.sortableOptions);return!1}
$(".dropdown-menu",$tb).hide()})))}
if(pluginName==="wiki text"){$li.append($("<div>").addClass("params card-body row").append($("<textarea>").addClass("form-control").val(typeof plugin==="string"?plugin:"")));return $li}
var $paramsDivs=$("<div>").addClass("params card-body d-flex flex-wrap"),value="",otherParams=[];for(var paramName in plugin.params){if(plugin.params.hasOwnProperty(paramName)){value=plugin.params[paramName];if(plugin.params){otherParams=plugin.params}else if(paramsDef[paramName]&&paramsDef[paramName].params){otherParams=paramsDef[paramName].params}
$paramsDivs.append(this.buildParam(pluginName,paramName,value,parentPath,otherParams))}}
$li.find(".card-header > div:first").append($paramsDivs.find(".btn-group").detach());$li.append($paramsDivs);var $ul=$("<ul>");if(plugin.plugins&&plugin.plugins.length){parentPath+="/"+plugin.name;if(plugin.params&&Object.keys(plugin.params).length){parentPath+="/"+Object.keys(plugin.params)[0];parentPath+="/"+plugin.params[Object.keys(plugin.params)[0]]}
for(var i=0;i<plugin.plugins.length;i++){$ul.append(gui.addPlugin(plugin.plugins[i],parentPath+(plugin.plugins[i].name?"/"+plugin.plugins[i].name:"")))}}
$ul.appendTo($li);return $li},getPlugin:function(path){if(!path){return{}}
var parts=path.split("/"),plugin=this.plugins,pluginOrParam=plugin;for(var i=0;i<parts.length;i++){if(parts[i]){if(typeof pluginOrParam[parts[i]]!=="undefined"){pluginOrParam=pluginOrParam[parts[i]];plugin=pluginOrParam}else if(pluginOrParam.plugins&&typeof pluginOrParam.plugins[parts[i]]!=="undefined"){pluginOrParam=pluginOrParam.plugins[parts[i]];plugin=pluginOrParam}else if(pluginOrParam.params&&typeof pluginOrParam.params[parts[i]]!=="undefined"){pluginOrParam=pluginOrParam.params[parts[i]]}else if(pluginOrParam.options&&typeof pluginOrParam.options[parts[i]]!=="undefined"){pluginOrParam=pluginOrParam.options[parts[i]]}}}
return plugin},buildParam:function(pluginName,paramName,value,parentPath,otherParams){var paramDef,gui=this,$input,$moreParamsDropDown="";if(paramName==="empty"){return}
if(paramName==="*"){paramName=prompt("Enter wikiplugin parameter name")}
value=value||"";parentPath=parentPath||"";otherParams=otherParams||{};var parentPlugin=gui.getPlugin(parentPath);if(gui.plugins[pluginName]&&typeof gui.plugins[pluginName].params[paramName]!=="undefined"){paramDef=this.plugins[pluginName].params[paramName]}
if(!paramDef&&parentPlugin&&parentPlugin.params){if(parentPlugin.params){paramDef=parentPlugin.params[paramName]}else{paramDef=parentPlugin.plugins[pluginName].params[paramName]}}
if(!paramDef&&otherParams){for(var otherParam in otherParams){if(otherParams.hasOwnProperty(otherParam)){if(otherParam===paramName){paramDef=otherParams[otherParam];break}}}}
if(!paramDef){console.log("Warning: param "+paramName+" not found in plugin "+pluginName);paramDef={}}
paramDef.name=paramName;var path=parentPath+"/"+pluginName+"/"+paramName;if(paramDef.options){var list=gui.arrayKeys(paramDef.options);if(pluginName==="output"&&paramName==="template"&&value&&($.inArray(value,list)===-1||value==="input")){$input=$("<input>").addClass("param-value form-control").val(value==="input"?"":value)}else{$input=gui.buildSelector(list,value,path)}}else{switch(paramDef.type){case "object_type":gui.objectType=value;$input=gui.objectTypesSelector(value);break;case "field":if(otherParams.format&&otherParams.format==="wikiplugin"){gui.trackerId=otherParams.content||otherParams.exact;$input=gui.pluginsSelector(value)}else{if(value==="tracker_id"){gui.trackerId=otherParams.content||otherParams.exact}
$input=gui.fieldsSelector(value)}
break;case "number":$input=$("<input>").attr("type","number").attr("step",paramDef.step?paramDef.step:1).addClass("param-value form-control").val(value);break;default:$input=$("<input>").addClass("param-value form-control").val(value)}}
$input.change(function(){if($input.is("select")&&paramDef.options&&$input.val()&&paramDef.options[$input.val()].plugins){$input.parents(".plugin").find(".btn-toolbar").empty().append(gui.buildToolBar(paramDef.options[$input.val()].plugins,pluginName,path+"/"+$input.val(),function(){if($(this).data("plugin")){var params=[];if($(this).data("value")){params[$(this).data("value")]=""}
$(this).parents(".plugin").find("> ul").append(gui.addPlugin({name:$(this).data("plugin"),params:params,plugins:[]},$(this).data("path"))).nestedSortable(gui.sortableOptions);return!1}
$(".dropdown-menu",$tb).hide()}))}});if(paramName==="format"&&this.plugins.display.params.name.params.format.options[value]){paramDef=this.plugins.display.params.name.params.format.options[value]}
if(paramDef.params){$input.data("params",gui.arrayKeys(paramDef.params));$moreParamsDropDown=this.buildDropDown(gui.arrayKeys(paramDef.params),tr("Parameters"),function(){var otherParams=paramDef.params;$input.parents(".params").append(gui.buildParam(pluginName,$(this).data("value"),"",path,otherParams))})}
if(value){setTimeout(function(){$input.change()},100)}
return $("<div class='col-md-6'>").append($moreParamsDropDown,$("<div class='input-group input-group-sm mb-2'>").append($("<div class='param-name input-group-prepend'>").append($("<span class='input-group-text'>").text(paramName)),$input,$("<div class='input-group-append'>").append($("<a class='input-group-text text-danger'>").html("&times;").click(function(){$(this).parents(".input-group").remove()}))))},arrayKeys:function(object){var list=[];for(var key in object){if(object.hasOwnProperty(key)){list.push(key)}}
return list},objectTypesSelector:function(value){var gui=this;return this.buildSelector(this.arrayKeys(this.fields.object_types),value,"",function(){gui.objectType=$(this).val()})},pluginsSelector:function(value){return $("<input>").addClass("param-value form-control").val(value)},paramsSelector:function(value){return this.buildSelector(this.arrayKeys(this.plugins[value]),'')},fieldsSelector:function(value){var i,fields;if(this.objectType&&this.fields.object_types.hasOwnProperty(this.objectType)){fields=this.fields.object_types[this.objectType];if(this.trackerId&&this.trackers[this.trackerId]){var generalFields=[],myTrackerFields=[],otherTrackerFields=[];for(i in fields){if(fields.hasOwnProperty(i)){if(fields[i].indexOf("tracker_field_")===0){if($.inArray(fields[i],this.trackers[this.trackerId])>-1){myTrackerFields.push(fields[i])}else{otherTrackerFields.push(fields[i])}}else{generalFields.push(fields[i])}}}
fields=generalFields;fields.push("--");fields=fields.concat(myTrackerFields);fields.push("--");fields=fields.concat(otherTrackerFields)}else{var fieldsArray=[];for(i in fields){if(fields.hasOwnProperty(i)){fieldsArray.push(fields[i])}}
fields=fieldsArray}}else{for(var type in this.fields.object_types){if(this.fields.object_types.hasOwnProperty(type)){if($.inArray(value,this.fields.object_types[type])>-1){this.objectType=type;fields=this.fields.object_types[type]}}}}
if(fields){fields.push("--")}else{fields=[]}
for(i=0;i<this.fields.global.length;i++){if($.inArray(this.fields.global[i],fields)<0){fields.push(this.fields.global[i])}}
if(this.fields.formatted){fields=fields.concat(this.fields.formatted)}
return this.buildSelector(fields,value)},buildSelector:function(list,value,parentPath,changeFunction){parentPath=parentPath||"";var $select=$("<select>").addClass("form-control noselect2");$select.append($("<option>").val("").text(""));for(var item in list){if(list.hasOwnProperty(item)){if(list[item]!=="--"){$select.append($("<option>").val(list[item]).text(tr(list[item])).prop("selected",list[item]===value).data("path",parentPath+"/"+list[item]))}else{$select.append("<option disabled>──────────</option>")}}}
if(changeFunction){$select.change(changeFunction)}
return $select},buildDropDown:function(list,title,clickFunction,icon,plugin,parentPath){if(!list.length){return""}
icon=icon||"plus";title=title||tr("Add");clickFunction=clickFunction||function(){};plugin=plugin||"";parentPath=parentPath||"";var $div=$("<div>").addClass("btn-group").append($("<a>").addClass("btn btn-link dropdown-toggle btn-sm").data("toggle","dropdown").attr("title",tr("Add")+" "+title).attr("href","#").append(title,$("<span>").getIcon(icon).addClass("pl-2"))),$ul=$("<div>").addClass("dropdown-menu").appendTo($div).append($("<div>").addClass("dropdown-header").text(title));for(var item in list){if(list.hasOwnProperty(item)){$ul.append($("<a>").addClass("dropdown-item").data("value",list[item]).data("plugin",plugin).data("path",parentPath+"/"+plugin+"/"+list[item]).text(tr(list[item])))}}
$(".dropdown-toggle",$div).dropdown();$div.find(".dropdown-menu a").click(function(){clickFunction.call(this);$(".dropdown-menu",$div).removeClass('show')});$(".dropdown-menu",$div).mouseleave(function(){$(".dropdown-menu",$div).removeClass('show')});return $div},buildToolBar:function(plugins,parent,parentPath,clickFunction){if(!plugins){return""}
parent=parent||"";parentPath=parentPath||"";clickFunction=clickFunction||function(){};var $div=$("<div>").addClass("btn-group");for(var plugin in plugins){if(plugins.hasOwnProperty(plugin)&&plugins[plugin].icon&&((!parent&&!plugins[plugin].parents)||(parent&&$.inArray(parent,plugins[plugin].parents)>-1))){$div.append(this.buildDropDown(this.arrayKeys(plugins[plugin].params),plugin,clickFunction,plugins[plugin].icon,plugin,parentPath))}}
return $div}}});
/* rank:60late - minify:ok. vendor_bundled/vendor/jquery-plugins/nestedsortable/jquery.ui.nestedSortable.js */
(function($){$.widget("ui.nestedSortable",$.extend({},$.ui.sortable.prototype,{options:{tabSize:20,disableNesting:'ui-nestedSortable-no-nesting',errorClass:'ui-nestedSortable-error',listType:'ol',maxLevels:0,noJumpFix:0},_create:function(){if(this.noJumpFix==!1)
this.element.height(this.element.height());this.element.data('sortable',this.element.data('nestedSortable'));return $.ui.sortable.prototype._create.apply(this,arguments)},_mouseDrag:function(event){this.position=this._generatePosition(event);this.positionAbs=this._convertPositionTo("absolute");if(!this.lastPositionAbs){this.lastPositionAbs=this.positionAbs}
if(this.options.scroll){var o=this.options,scrolled=!1;if(this.scrollParent[0]!=document&&this.scrollParent[0].tagName!='HTML'){if((this.overflowOffset.top+this.scrollParent[0].offsetHeight)-event.pageY<o.scrollSensitivity)
this.scrollParent[0].scrollTop=scrolled=this.scrollParent[0].scrollTop+o.scrollSpeed;else if(event.pageY-this.overflowOffset.top<o.scrollSensitivity)
this.scrollParent[0].scrollTop=scrolled=this.scrollParent[0].scrollTop-o.scrollSpeed;if((this.overflowOffset.left+this.scrollParent[0].offsetWidth)-event.pageX<o.scrollSensitivity)
this.scrollParent[0].scrollLeft=scrolled=this.scrollParent[0].scrollLeft+o.scrollSpeed;else if(event.pageX-this.overflowOffset.left<o.scrollSensitivity)
this.scrollParent[0].scrollLeft=scrolled=this.scrollParent[0].scrollLeft-o.scrollSpeed}else{if(event.pageY-$(document).scrollTop()<o.scrollSensitivity)
scrolled=$(document).scrollTop($(document).scrollTop()-o.scrollSpeed);else if($(window).height()-(event.pageY-$(document).scrollTop())<o.scrollSensitivity)
scrolled=$(document).scrollTop($(document).scrollTop()+o.scrollSpeed);if(event.pageX-$(document).scrollLeft()<o.scrollSensitivity)
scrolled=$(document).scrollLeft($(document).scrollLeft()-o.scrollSpeed);else if($(window).width()-(event.pageX-$(document).scrollLeft())<o.scrollSensitivity)
scrolled=$(document).scrollLeft($(document).scrollLeft()+o.scrollSpeed)}
if(scrolled!==!1&&$.ui.ddmanager&&!o.dropBehaviour)
$.ui.ddmanager.prepareOffsets(this,event)}
this.positionAbs=this._convertPositionTo("absolute");if(!this.options.axis||this.options.axis!="y")this.helper[0].style.left=this.position.left+'px';if(!this.options.axis||this.options.axis!="x")this.helper[0].style.top=this.position.top+'px';for(var i=this.items.length-1;i>=0;i--){var item=this.items[i],itemElement=item.item[0],intersection=this._intersectsWithPointer(item);if(!intersection)continue;if(itemElement!=this.currentItem[0]&&this.placeholder[intersection==1?"next":"prev"]()[0]!=itemElement&&!$.contains(this.placeholder[0],itemElement)&&(this.options.type=='semi-dynamic'?!$.contains(this.element[0],itemElement):!0)){this.direction=intersection==1?"down":"up";if(this.options.tolerance=="pointer"||this._intersectsWithSides(item)){this._rearrange(event,item)}else{break}
this._clearEmpty(itemElement);this._trigger("change",event,this._uiHash());break}}
var parentItem=(this.placeholder[0].parentNode.parentNode&&$(this.placeholder[0].parentNode.parentNode).closest('.ui-sortable').length)?$(this.placeholder[0].parentNode.parentNode):null;var level=this._getLevel(this.placeholder);var childLevels=this._getChildLevels(this.helper);var previousItem=this.placeholder[0].previousSibling?$(this.placeholder[0].previousSibling):null;if(previousItem!=null){while(previousItem[0].nodeName.toLowerCase()!='li'||previousItem[0]==this.currentItem[0]){if(previousItem[0].previousSibling){previousItem=$(previousItem[0].previousSibling)}else{previousItem=null;break}}}
newList=document.createElement(o.listType);this.beyondMaxLevels=0;if(parentItem!=null&&this.positionAbs.left<parentItem.offset().left){parentItem.after(this.placeholder[0]);this._clearEmpty(parentItem[0]);this._trigger("change",event,this._uiHash())}else if(previousItem!=null&&this.positionAbs.left>previousItem.offset().left+o.tabSize){this._isAllowed(previousItem,level+childLevels+1);if(previousItem[0].children[1]==null){previousItem[0].appendChild(newList)}
previousItem[0].children[1].appendChild(this.placeholder[0]);this._trigger("change",event,this._uiHash())}else{this._isAllowed(parentItem,level+childLevels)}
this._contactContainers(event);if($.ui.ddmanager)$.ui.ddmanager.drag(this,event);this._trigger('sort',event,this._uiHash());this.lastPositionAbs=this.positionAbs;return!1},_mouseStop:function(event,noPropagation){if(this.beyondMaxLevels){var parent=this.placeholder.parent().closest(this.options.items);for(var i=this.beyondMaxLevels-1;i>0;i--){parent=parent.parent().closest(this.options.items)}
this.placeholder.removeClass(this.options.errorClass);parent.after(this.placeholder);this._trigger("change",event,this._uiHash())}
$.ui.sortable.prototype._mouseStop.apply(this,arguments)},serialize:function(o){var items=this._getItemsAsjQuery(o&&o.connected);var str=[];o=o||{};$(items).each(function(){var res=($(o.item||this).attr(o.attribute||'id')||'').match(o.expression||(/(.+)[-=_](.+)/));var pid=($(o.item||this).parent(o.listType).parent('li').attr(o.attribute||'id')||'').match(o.expression||(/(.+)[-=_](.+)/));if(res)str.push((o.key||res[1]+'['+(o.key&&o.expression?res[1]:res[2])+']')+'='+(pid?(o.key&&o.expression?pid[1]:pid[2]):'root'))});if(!str.length&&o.key){str.push(o.key+'=')}
return str.join('&')},toHierarchy:function(o){o=o||{};var sDepth=o.startDepthCount||0;var ret=[];$(this.element).children('li').each(function(){var level=_recursiveItems($(this));ret.push(level)});return ret;function _recursiveItems(li){var id=($(li).attr(o.attribute||'id')||'').match(o.expression||(/(.+)[-=_](.+)/));if(id!=null){var item={"id":id[2]};if($(li).children(o.listType).children('li').length>0){item.children=[];$(li).children(o.listType).children('li').each(function(){var level=_recursiveItems($(this));item.children.push(level)})}
return item}}},toArray:function(o){o=o||{};var sDepth=o.startDepthCount||0;var ret=[];var left=2;ret.push({"item_id":'root',"parent_id":'none',"depth":sDepth,"left":'1',"right":($('li',this.element).length+1)*2});$(this.element).children('li').each(function(){left=_recursiveArray(this,sDepth+1,left)});function _sortByLeft(a,b){return a.left-b.left}
ret=ret.sort(_sortByLeft);return ret;function _recursiveArray(item,depth,left){right=left+1;if($(item).children(o.listType).children('li').length>0){depth ++;$(item).children(o.listType).children('li').each(function(){right=_recursiveArray($(this),depth,right)});depth --}
id=($(item).attr(o.attribute||'id')).match(o.expression||(/(.+)[-=_](.+)/));if(depth===sDepth+1)pid='root';else{parentItem=($(item).parent(o.listType).parent('li').attr('id')).match(o.expression||(/(.+)[-=_](.+)/));pid=parentItem[2]}
if(id!=null){ret.push({"item_id":id[2],"parent_id":pid,"depth":depth,"left":left,"right":right})}
return left=right+1}},_clear:function(event,noPropagation){$.ui.sortable.prototype._clear.apply(this,arguments);for(var i=this.items.length-1;i>=0;i--){var item=this.items[i].item[0];this._clearEmpty(item)}
return!0},_clearEmpty:function(item){if(item.children[1]&&item.children[1].children.length==0){item.removeChild(item.children[1])}},_getLevel:function(item){var level=1;if(this.options.listType){var list=item.closest(this.options.listType);while(!list.is('.ui-sortable')){level++;list=list.parent().closest(this.options.listType)}}
return level},_getChildLevels:function(parent,depth){var self=this,o=this.options,result=0;depth=depth||0;$(parent).children(o.listType).children(o.items).each(function(index,child){result=Math.max(self._getChildLevels(child,depth+1),result)});return depth?result+1:result},_isAllowed:function(parentItem,levels){var o=this.options
if(parentItem==null||!(parentItem.hasClass(o.disableNesting))){if(o.maxLevels<levels&&o.maxLevels!=0){this.placeholder.addClass(o.errorClass);this.beyondMaxLevels=levels-o.maxLevels}else{this.placeholder.removeClass(o.errorClass);this.beyondMaxLevels=0}}else{this.placeholder.addClass(o.errorClass);this.beyondMaxLevels=(levels-o.maxLevels)>0?levels-o.maxLevels:1}}}));$.ui.nestedSortable.prototype.options=$.extend({},$.ui.sortable.prototype.options,$.ui.nestedSortable.prototype.options)})(jQuery);
/* rank:60late - minify:ok. vendor/npm-asset/lozad/dist/lozad.js */
/*! lozad.js - v1.7.0 - 2018-11-08
* https://github.com/ApoorvSaxena/lozad.js
* Copyright (c) 2018 Apoorv Saxena; Licensed MIT */
(function(global,factory){typeof exports==='object'&&typeof module!=='undefined'?module.exports=factory():typeof define==='function'&&define.amd?define(factory):(global.lozad=factory())}(this,(function(){'use strict';var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var isIE=typeof document!=='undefined'&&document.documentMode;var defaultConfig={rootMargin:'0px',threshold:0,load:function load(element){if(element.nodeName.toLowerCase()==='picture'){var img=document.createElement('img');if(isIE&&element.getAttribute('data-iesrc')){img.src=element.getAttribute('data-iesrc')}
if(element.getAttribute('data-alt')){img.alt=element.getAttribute('data-alt')}
element.appendChild(img)}
if(element.getAttribute('data-src')){element.src=element.getAttribute('data-src')}
if(element.getAttribute('data-srcset')){element.setAttribute('srcset',element.getAttribute('data-srcset'))}
if(element.getAttribute('data-background-image')){element.style.backgroundImage='url(\''+element.getAttribute('data-background-image')+'\')'}
if(element.getAttribute('data-toggle-class')){element.classList.toggle(element.getAttribute('data-toggle-class'))}},loaded:function loaded(){}};function markAsLoaded(element){element.setAttribute('data-loaded',!0)}
var isLoaded=function isLoaded(element){return element.getAttribute('data-loaded')==='true'};var onIntersection=function onIntersection(load,loaded){return function(entries,observer){entries.forEach(function(entry){if(entry.intersectionRatio>0||entry.isIntersecting){observer.unobserve(entry.target);if(!isLoaded(entry.target)){load(entry.target);markAsLoaded(entry.target);loaded(entry.target)}}})}};var getElements=function getElements(selector){var root=arguments.length>1&&arguments[1]!==undefined?arguments[1]:document;if(selector instanceof Element){return[selector]}
if(selector instanceof NodeList){return selector}
return root.querySelectorAll(selector)};function lozad(){var selector=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'.lozad';var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var _defaultConfig$option=_extends({},defaultConfig,options),root=_defaultConfig$option.root,rootMargin=_defaultConfig$option.rootMargin,threshold=_defaultConfig$option.threshold,load=_defaultConfig$option.load,loaded=_defaultConfig$option.loaded;var observer=void 0;if(window.IntersectionObserver){observer=new IntersectionObserver(onIntersection(load,loaded),{root:root,rootMargin:rootMargin,threshold:threshold})}
return{observe:function observe(){var elements=getElements(selector,root);for(var i=0;i<elements.length;i++){if(isLoaded(elements[i])){continue}
if(observer){observer.observe(elements[i]);continue}
load(elements[i]);markAsLoaded(elements[i]);loaded(elements[i])}},triggerLoad:function triggerLoad(element){if(isLoaded(element)){return}
load(element);markAsLoaded(element);loaded(element)},observer:observer}}
return lozad})))